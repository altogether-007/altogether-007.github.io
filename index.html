<?php

/**
 * 
 * HTML Hider v0.1
 * By AyoobAli.com
 * License: The MIT License (MIT)
 * Copyright (c) 2015 Ayoob Ali
 * 
 * This tool will hide the HTML source code of your page from the normal 'view source' option.
 * 
 * Use:-
 * include('HTMLhider.class.php');
 * $hider = new \HTMLhider\hider();
 * $hider->hide($FullHTMLpage);
 * $hider->activateJS();
 * echo $hider->getHiddenPage();
 * 
 */

include ( "../HTMLhider.class.php" );

$hider = new \HTMLhider\hider();
$hider->setJSpath('../hjs.php');

$tempPage = <<< EOF


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            background-color: #333;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 1px solid #888;
            background-color: #444;
            border-radius: 10px;
        }
        #controls {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .dpad {
            display: flex;
            justify-content: center;
            margin-bottom: 5px;
        }
        button {
            margin: 5px;
            padding: 15px;
            background-color: #555;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            width: 60px;
            height: 60px;
            font-size: 20px;
        }
        button:hover {
            background-color: #666;
        }
        #speedControl {
            margin-top: 10px;
            width: 200px;
        }
        #score {
            margin-top: 10px;
            font-size: 20px;
        }
        #restart {
            margin-top: 10px;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: none;
        }
        #restart:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <div id="controls">
        <div class="dpad">
            <button onclick="changeDirection('UP')">‚Üë</button>
        </div>
        <div class="dpad">
            <button onclick="changeDirection('LEFT')">‚Üê</button>
            <button onclick="changeDirection('RIGHT')">‚Üí</button>
        </div>
        <div class="dpad">
            <button onclick="changeDirection('DOWN')">‚Üì</button>
        </div>
        <input type="range" id="speedControl" min="50" max="300" value="100" onchange="changeSpeed()" />
        <label for="speedControl">Speed</label>
    </div>
    <div id="score">Score: 0</div>
    <button id="restart" onclick="restartGame()">üîÑ</button>
    <audio id="eatSound" src="eat.mp3"></audio>
    <audio id="gameOverSound" src="gameover.mp3"></audio>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        const box = 20;
        let snake, direction, food, score, game, speed = 100;
        let highScore = 0;
        let obstacles = [];
        let powerUps = [];
        let snakeColor = "lime";

        function init() {
            snake = [{ x: 9 * box, y: 9 * box }];
            direction = "RIGHT";
            food = generateFood();
            score = 0;
            obstacles = [];
            document.getElementById("score").innerText = "Score: " + score;
            document.getElementById("restart").style.display = "none"; // Hide restart button
            clearInterval(game);
            game = setInterval(draw, speed);
        }

        function generateFood() {
            return {
                x: Math.floor(Math.random() * (canvas.width / box)) * box,
                y: Math.floor(Math.random() * (canvas.height / box)) * box,
                color: getRandomColor()
            };
        }

        function generateObstacle() {
            const x = Math.floor(Math.random() * (canvas.width / box)) * box;
            const y = Math.floor(Math.random() * (canvas.height / box)) * box;
            obstacles.push({ x, y });
        }

        function generatePowerUp() {
            const x = Math.floor(Math.random() * (canvas.width / box)) * box;
            const y = Math.floor(Math.random() * (canvas.height / box)) * box;
            powerUps.push({ x, y });
        }

        function getRandomColor() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

        function changeDirection(newDirection) {
            if (newDirection === "LEFT" && direction !== "RIGHT") {
                direction = "LEFT";
            } else if (newDirection === "UP" && direction !== "DOWN") {
                direction = "UP";
            } else if (newDirection === "RIGHT" && direction !== "LEFT") {
                direction = "RIGHT";
            } else if (newDirection === "DOWN" && direction !== "UP") {
                direction = "DOWN";
            }
        }

        function changeSpeed() {
            speed = document.getElementById("speedControl").value;
            clearInterval(game);
            game = setInterval(draw, speed);
        }

        document.addEventListener("keydown", (event) => {
            if (event.key === "ArrowLeft") changeDirection("LEFT");
            else if (event.key === "ArrowUp") changeDirection("UP");
            else if (event.key === "ArrowRight") changeDirection("RIGHT");
            else if (event.key === "ArrowDown") changeDirection("DOWN");
        });

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawGrid();
            drawSnake();
            drawFood();
            drawObstacles();
            drawPowerUps();

            const snakeX = snake[0].x;
            const snakeY = snake[0].y;

            let newHead;
            if (direction === "LEFT") newHead = { x: (snakeX - box + canvas.width) % canvas.width, y: snakeY };
            if (direction === "UP") newHead = { x: snakeX, y: (snakeY - box + canvas.height) % canvas.height };
            if (direction === "RIGHT") newHead = { x: (snakeX + box) % canvas.width, y: snakeY };
            if (direction === "DOWN") newHead = { x: snakeX, y: (snakeY + box) % canvas.height };

            if (collision(newHead, snake) || collision(newHead, obstacles)) {
                clearInterval(game);
                document.getElementById("gameOverSound").play();
                document.getElementById("restart").style.display = "block"; // Show restart button
                alert("Game Over! Your score: " + score);
                if (score > highScore) {
                    highScore = score;
                    alert("New High Score: " + highScore);
                }
                return;
            }

            snake.unshift(newHead);

            if (snakeX === food.x && snakeY === food.y) {
                document.getElementById("eatSound").play();
                score++;
                speed = Math.max(50, speed - 5);
                food = generateFood();
                document.getElementById("score").innerText = "Score: " + score;
                snakeColor = getRandomColor();
                generateObstacle();
                if (Math.random() < 0.2) generatePowerUp();
            } else {
                snake.pop();
            }

            for (let i = 0; i < powerUps.length; i++) {
                if (newHead.x === powerUps[i].x && newHead.y === powerUps[i].y) {
                    powerUps.splice(i, 1);
                    score += 2;
                    document.getElementById("score").innerText = "Score: " + score;
                }
            }
        }

        function drawGrid() {
            ctx.strokeStyle = "darkgrey";
            for (let x = 0; x < canvas.width; x += box) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y < canvas.height; y += box) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }

        function drawSnake() {
            for (let i = 0; i < snake.length; i++) {
                ctx.fillStyle = i === 0 ? "darkgreen" : snakeColor;
                ctx.fillRect(snake[i].x, snake[i].y, box, box);
                ctx.strokeStyle = "darkgreen";
                ctx.strokeRect(snake[i].x, snake[i].y, box, box);
            }
        }

        function drawFood() {
            ctx.fillStyle = food.color;
            ctx.beginPath();
            ctx.arc(food.x + box / 2, food.y + box / 2, box / 2, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawObstacles() {
            ctx.fillStyle = "red";
            for (const obs of obstacles) {
                ctx.fillRect(obs.x, obs.y, box, box);
            }
        }

        function drawPowerUps() {
            ctx.fillStyle = "gold";
            for (const powerUp of powerUps) {
                ctx.beginPath();
                ctx.arc(powerUp.x + box / 2, powerUp.y + box / 2, box / 2, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function collision(head, array) {
            for (let i = 0; i < array.length; i++) {
                if (head.x === array[i].x && head.y === array[i].y) {
                    return true;
                }
            }
            return false;
        }

        function restartGame() {
            init();
        }

        init();
    </script>
</body>
</html>
  
  EOF;

$hider->hide( $tempPage );

echo $hider->getHiddenPage( true );

?>
